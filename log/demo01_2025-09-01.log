2025-09-01 14:35:36.269 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 25428 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 14:35:36.271 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 14:35:36.955 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 14:35:36.956 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 14:35:36.987 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2025-09-01 14:35:37.616 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 14:35:37.638 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 14:35:37.640 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 14:35:37.640 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 14:35:37.759 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 14:35:37.760 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1446 ms
2025-09-01 14:35:39.139 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 14:35:39.165 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 14:35:39.169 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:35:39.175 [main] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Broker not available; cannot force queue declarations during start: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:35:39.182 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:35:39.185 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
	at org.springframework.amqp.rabbit.support.RabbitExceptionTranslator.convertRabbitAccessException(RabbitExceptionTranslator.java:61)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.createBareConnection(AbstractConnectionFactory.java:632)
	at org.springframework.amqp.rabbit.connection.CachingConnectionFactory.createConnection(CachingConnectionFactory.java:726)
	at org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils.createConnection(ConnectionFactoryUtils.java:257)
	at org.springframework.amqp.rabbit.core.RabbitTemplate.doExecute(RabbitTemplate.java:2262)
	at org.springframework.amqp.rabbit.core.RabbitTemplate.execute(RabbitTemplate.java:2235)
	at org.springframework.amqp.rabbit.core.RabbitTemplate.execute(RabbitTemplate.java:2215)
	at org.springframework.amqp.rabbit.core.RabbitAdmin.getQueueInfo(RabbitAdmin.java:467)
	at org.springframework.amqp.rabbit.core.RabbitAdmin.getQueueProperties(RabbitAdmin.java:451)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.attemptDeclarations(AbstractMessageListenerContainer.java:1972)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.redeclareElementsIfNecessary(AbstractMessageListenerContainer.java:1936)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.initialize(SimpleMessageListenerContainer.java:1481)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1322)
	at java.base/java.lang.Thread.run(Thread.java:1447)
Caused by: java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:628)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:533)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:583)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:282)
	at java.base/java.net.Socket.connect(Socket.java:665)
	at com.rabbitmq.client.impl.SocketFrameHandlerFactory.create(SocketFrameHandlerFactory.java:61)
	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1249)
	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1198)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.connectAddresses(AbstractConnectionFactory.java:678)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.connect(AbstractConnectionFactory.java:647)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.createBareConnection(AbstractConnectionFactory.java:593)
	... 12 common frames omitted
2025-09-01 14:35:39.191 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:35:39.211 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 3.263 seconds (process running for 3.995)
2025-09-01 14:35:44.217 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:35:44.222 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@be083e1: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:35:44.223 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:35:44.225 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:35:44.225 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:35:49.236 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:35:49.236 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@49a05cdd: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:35:49.237 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:35:49.248 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:35:49.249 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:35:54.265 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:35:54.265 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@6275d256: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:35:54.266 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:35:54.277 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:35:54.277 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:35:58.255 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 14:35:58.256 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 14:35:58.257 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-01 14:35:58.347 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 14:35:58.578 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@a90fc16
2025-09-01 14:35:58.581 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 14:35:58.631 [http-nio-8081-exec-1] INFO  c.r.play_record.service.impl.SyncServiceImpl - 用户9在2025-09-01第一次插入总时长
2025-09-01 14:35:58.674 [http-nio-8081-exec-1] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为30，未达到最低发奖门槛
2025-09-01 14:35:59.292 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:35:59.292 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@c82b272: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:35:59.293 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-5] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:35:59.304 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-5] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:35:59.305 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-5] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:04.330 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-5] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:04.330 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-5] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@49a0b7ed: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:04.332 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-6] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:04.342 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-6] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:04.343 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-6] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:09.540 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-6] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:09.540 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-6] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@a4763b6: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:09.542 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-7] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:09.546 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-7] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:09.547 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-7] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:14.602 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-7] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:14.603 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-7] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@2460e04c: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:14.605 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-8] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:14.619 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-8] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:14.619 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-8] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:19.812 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-8] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:19.813 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-8] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@6e48253f: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:19.815 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-9] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:19.829 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-9] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:19.829 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-9] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:24.879 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-9] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:24.879 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-9] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@2d1cdf76: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:24.880 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-10] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:24.896 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-10] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:24.896 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-10] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:29.917 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-10] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:29.917 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-10] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@6cbda792: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:29.919 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-11] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:29.934 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-11] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:29.934 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-11] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:35.152 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-11] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:35.152 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-11] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@46f82a95: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:35.154 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-12] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:35.156 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-12] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:35.156 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-12] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:40.189 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-12] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:40.190 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-12] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@3f54299a: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:40.193 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-13] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:40.220 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-13] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:40.220 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-13] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:45.380 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-13] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:45.381 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-13] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@6406714c: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:45.383 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-14] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:45.386 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-14] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:45.386 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-14] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:48.543 [http-nio-8081-exec-2] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为60，未达到最低发奖门槛
2025-09-01 14:36:49.794 [http-nio-8081-exec-3] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为90，未达到最低发奖门槛
2025-09-01 14:36:50.583 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-14] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:50.583 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-14] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@654cd8a7: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:50.585 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-15] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:50.599 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-15] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:50.599 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-15] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:51.164 [http-nio-8081-exec-6] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为120，未达到最低发奖门槛
2025-09-01 14:36:52.413 [http-nio-8081-exec-5] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为150，未达到最低发奖门槛
2025-09-01 14:36:54.118 [http-nio-8081-exec-4] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:55.086 [http-nio-8081-exec-7] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:55.754 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-15] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:36:55.754 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-15] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@547130aa: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:36:55.757 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-16] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:36:55.770 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-16] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:36:55.770 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-16] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:00.880 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-16] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:00.881 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-16] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@1147ba0c: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:37:00.895 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-17] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:00.897 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-17] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:37:00.897 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-17] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:06.130 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-17] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:06.130 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-17] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@7b3560e4: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:37:06.133 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-18] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:06.161 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-18] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:37:06.161 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-18] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:11.283 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-18] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:11.283 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-18] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@41548b79: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:37:11.284 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-19] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:11.286 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-19] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:37:11.286 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-19] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:16.311 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-19] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:16.311 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-19] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@7e959861: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:37:16.312 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-20] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:16.323 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-20] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:37:16.323 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-20] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:21.349 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-20] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:21.349 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-20] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@6276e97b: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:37:21.350 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-21] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:21.360 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-21] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:37:21.361 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-21] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:26.378 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-21] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:26.378 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-21] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@74d3ee4b: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:37:26.380 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-22] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:26.381 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-22] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:37:26.382 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-22] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:31.398 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-22] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:31.398 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-22] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@5ff17aa7: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:37:31.399 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-23] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:31.400 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-23] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:37:31.400 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-23] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:36.428 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-23] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:36.428 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-23] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@4ae23a9b: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:37:36.429 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-24] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:36.441 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-24] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:37:36.441 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-24] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:41.640 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-24] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:41.640 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-24] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@7521d325: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:37:41.641 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-25] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:41.643 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-25] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:37:41.643 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-25] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:45.690 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-26] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 14:37:45.692 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-26] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 14:37:45.692 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 14:37:45.731 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 14:37:45.746 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 14:37:45.751 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 14:37:51.405 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 10928 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 14:37:51.406 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 14:37:52.002 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 14:37:52.004 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 14:37:52.036 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2025-09-01 14:37:52.511 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 14:37:52.522 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 14:37:52.524 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 14:37:52.525 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 14:37:52.579 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 14:37:52.579 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1135 ms
2025-09-01 14:37:53.586 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 14:37:53.602 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 14:37:53.604 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:53.619 [main] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Broker not available; cannot force queue declarations during start: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:53.626 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:53.628 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
	at org.springframework.amqp.rabbit.support.RabbitExceptionTranslator.convertRabbitAccessException(RabbitExceptionTranslator.java:61)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.createBareConnection(AbstractConnectionFactory.java:632)
	at org.springframework.amqp.rabbit.connection.CachingConnectionFactory.createConnection(CachingConnectionFactory.java:726)
	at org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils.createConnection(ConnectionFactoryUtils.java:257)
	at org.springframework.amqp.rabbit.core.RabbitTemplate.doExecute(RabbitTemplate.java:2262)
	at org.springframework.amqp.rabbit.core.RabbitTemplate.execute(RabbitTemplate.java:2235)
	at org.springframework.amqp.rabbit.core.RabbitTemplate.execute(RabbitTemplate.java:2215)
	at org.springframework.amqp.rabbit.core.RabbitAdmin.getQueueInfo(RabbitAdmin.java:467)
	at org.springframework.amqp.rabbit.core.RabbitAdmin.getQueueProperties(RabbitAdmin.java:451)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.attemptDeclarations(AbstractMessageListenerContainer.java:1972)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.redeclareElementsIfNecessary(AbstractMessageListenerContainer.java:1936)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.initialize(SimpleMessageListenerContainer.java:1481)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1322)
	at java.base/java.lang.Thread.run(Thread.java:1447)
Caused by: java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:628)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:533)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:583)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:282)
	at java.base/java.net.Socket.connect(Socket.java:665)
	at com.rabbitmq.client.impl.SocketFrameHandlerFactory.create(SocketFrameHandlerFactory.java:61)
	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1249)
	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1198)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.connectAddresses(AbstractConnectionFactory.java:678)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.connect(AbstractConnectionFactory.java:647)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.createBareConnection(AbstractConnectionFactory.java:593)
	... 12 common frames omitted
2025-09-01 14:37:53.631 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:53.643 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.535 seconds (process running for 3.468)
2025-09-01 14:37:58.653 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:37:58.656 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@5ca86715: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:37:58.658 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:37:58.659 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:37:58.660 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:38:03.697 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:38:03.697 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@49a05cdd: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:38:03.698 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:38:03.701 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:38:03.701 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:38:07.205 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 14:38:07.206 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 14:38:07.208 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 14:38:07.254 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 14:49:03.207 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 4416 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 14:49:03.209 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 14:49:03.763 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 14:49:03.765 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 14:49:03.788 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
2025-09-01 14:49:04.211 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 14:49:04.222 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 14:49:04.223 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 14:49:04.224 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 14:49:04.275 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 14:49:04.276 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1020 ms
2025-09-01 14:49:05.237 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 14:49:05.261 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 14:49:05.263 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:05.277 [main] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Broker not available; cannot force queue declarations during start: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:49:05.282 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:05.293 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
	at org.springframework.amqp.rabbit.support.RabbitExceptionTranslator.convertRabbitAccessException(RabbitExceptionTranslator.java:61)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.createBareConnection(AbstractConnectionFactory.java:632)
	at org.springframework.amqp.rabbit.connection.CachingConnectionFactory.createConnection(CachingConnectionFactory.java:726)
	at org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils.createConnection(ConnectionFactoryUtils.java:257)
	at org.springframework.amqp.rabbit.core.RabbitTemplate.doExecute(RabbitTemplate.java:2262)
	at org.springframework.amqp.rabbit.core.RabbitTemplate.execute(RabbitTemplate.java:2235)
	at org.springframework.amqp.rabbit.core.RabbitTemplate.execute(RabbitTemplate.java:2215)
	at org.springframework.amqp.rabbit.core.RabbitAdmin.getQueueInfo(RabbitAdmin.java:467)
	at org.springframework.amqp.rabbit.core.RabbitAdmin.getQueueProperties(RabbitAdmin.java:451)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.attemptDeclarations(AbstractMessageListenerContainer.java:1972)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.redeclareElementsIfNecessary(AbstractMessageListenerContainer.java:1936)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.initialize(SimpleMessageListenerContainer.java:1481)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1322)
	at java.base/java.lang.Thread.run(Thread.java:1447)
Caused by: java.net.ConnectException: Connection refused: getsockopt
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:628)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:533)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:583)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:282)
	at java.base/java.net.Socket.connect(Socket.java:665)
	at com.rabbitmq.client.impl.SocketFrameHandlerFactory.create(SocketFrameHandlerFactory.java:61)
	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1249)
	at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1198)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.connectAddresses(AbstractConnectionFactory.java:678)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.connect(AbstractConnectionFactory.java:647)
	at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.createBareConnection(AbstractConnectionFactory.java:593)
	... 12 common frames omitted
2025-09-01 14:49:05.297 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:05.305 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.414 seconds (process running for 3.118)
2025-09-01 14:49:10.313 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:49:10.315 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@3164d5aa: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:49:10.318 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:10.328 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:49:10.329 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:15.358 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:49:15.358 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@519952fa: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:49:15.360 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:15.382 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:49:15.382 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:20.406 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:49:20.406 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-3] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@41da7255: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:49:20.407 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:20.420 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:49:20.420 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:25.447 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:49:25.447 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-4] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@50860a69: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:49:25.449 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-5] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:25.450 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-5] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:49:25.451 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-5] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:30.478 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-5] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Consumer raised exception, processing can restart if the connection factory supports it. Exception summary: org.springframework.amqp.AmqpConnectException: java.net.ConnectException: Connection refused: getsockopt
2025-09-01 14:49:30.479 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-5] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Restarting Consumer@2fce6359: tags=[[]], channel=null, acknowledgeMode=AUTO local queue size=0
2025-09-01 14:49:30.481 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-6] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:30.504 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-6] ERROR o.s.a.r.listener.SimpleMessageListenerContainer - Failed to check/redeclare auto-delete queue(s).
2025-09-01 14:49:30.504 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-6] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:32.510 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-7] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 14:49:32.510 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-7] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 14:49:32.512 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 14:49:32.553 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 14:49:42.184 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 29224 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 14:49:42.186 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 14:49:42.855 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 14:49:42.857 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 14:49:42.882 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-01 14:49:43.354 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 14:49:43.365 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 14:49:43.366 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 14:49:43.367 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 14:49:43.423 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 14:49:43.423 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1192 ms
2025-09-01 14:49:44.441 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 14:49:44.457 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 14:49:44.460 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 14:49:44.494 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#21d9cd04:0/SimpleConnection@41f90b10 [delegate=amqp://guest@127.0.0.1:5672/, localPort=52499]
2025-09-01 14:49:44.499 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 14:49:44.545 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.672 seconds (process running for 3.58)
2025-09-01 14:50:42.033 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 14:50:42.033 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 14:50:42.033 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-01 14:50:42.146 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 14:50:42.419 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4931d96e
2025-09-01 14:50:42.420 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 14:50:43.481 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1，失败原因为code为coin的coin不存在
2025-09-01 14:50:43.511 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 14:50:43.526 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1，失败原因为code为coin的coin不存在
2025-09-01 14:50:45.531 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 14:50:45.540 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1，失败原因为code为coin的coin不存在
2025-09-01 14:50:47.542 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 14:50:47.554 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1，失败原因为code为coin的coin不存在
2025-09-01 14:50:47.555 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_coin_coin01_1的发奖已重试三次，依旧失败
2025-09-01 15:15:57.138 [http-nio-8081-exec-4] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:15:57.145 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 15:15:57.156 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:15:59.157 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 15:15:59.169 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:16:01.172 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 15:16:01.183 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:16:01.185 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_coin_coin01_1的发奖已重试三次，依旧失败
2025-09-01 15:18:22.139 [http-nio-8081-exec-3] INFO  c.r.play_record.service.impl.SyncServiceImpl - 用户9在2025-09-01第一次插入总时长
2025-09-01 15:18:22.146 [http-nio-8081-exec-3] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为30，未达到最低发奖门槛
2025-09-01 15:18:43.514 [http-nio-8081-exec-6] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为60，未达到最低发奖门槛
2025-09-01 15:18:44.547 [http-nio-8081-exec-7] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为90，未达到最低发奖门槛
2025-09-01 15:18:45.987 [http-nio-8081-exec-8] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为120，未达到最低发奖门槛
2025-09-01 15:18:46.798 [http-nio-8081-exec-9] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为150，未达到最低发奖门槛
2025-09-01 15:18:49.928 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为210，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_credit_credit01_1
2025-09-01 15:20:10.639 [http-nio-8081-exec-4] INFO  c.r.play_record.service.impl.SyncServiceImpl - 用户9在2025-09-01第一次插入总时长
2025-09-01 15:20:10.646 [http-nio-8081-exec-4] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为30，未达到最低发奖门槛
2025-09-01 15:20:22.248 [http-nio-8081-exec-5] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为60，未达到最低发奖门槛
2025-09-01 15:20:23.372 [http-nio-8081-exec-3] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为90，未达到最低发奖门槛
2025-09-01 15:20:24.459 [http-nio-8081-exec-6] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为120，未达到最低发奖门槛
2025-09-01 15:20:25.393 [http-nio-8081-exec-7] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为150，未达到最低发奖门槛
2025-09-01 15:21:15.108 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 15:21:15.960 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 15:21:15.962 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 15:21:15.983 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 15:21:16.004 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 15:21:16.007 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 15:21:25.353 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 11536 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 15:21:25.355 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 15:21:25.971 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 15:21:25.973 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 15:21:25.995 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-01 15:21:26.480 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 15:21:26.493 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 15:21:26.495 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 15:21:26.496 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 15:21:26.569 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 15:21:26.570 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1171 ms
2025-09-01 15:21:27.617 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 15:21:27.633 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 15:21:27.634 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 15:21:27.682 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7185e611:0/SimpleConnection@c6bf8d9 [delegate=amqp://guest@127.0.0.1:5672/, localPort=54772]
2025-09-01 15:21:27.687 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 15:21:27.743 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.702 seconds (process running for 3.573)
2025-09-01 15:21:42.837 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 15:21:42.838 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 15:21:42.840 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-09-01 15:21:43.008 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 15:21:43.383 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@61fe0c82
2025-09-01 15:21:43.386 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 15:21:43.678 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 15:21:45.701 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 15:21:47.714 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 15:21:47.719 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_coin_coin01_1的发奖已重试三次，依旧失败
2025-09-01 15:22:08.035 [http-nio-8081-exec-2] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:22:08.040 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:22:08.049 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:22:10.052 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:22:10.062 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:22:12.064 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:22:12.074 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:22:12.076 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_coin_coin01_2的发奖已重试三次，依旧失败
2025-09-01 15:23:49.269 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 15:23:50.172 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 15:23:50.173 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 15:23:50.199 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 15:23:50.220 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 15:23:50.225 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 15:23:52.312 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 10904 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 15:23:52.314 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 15:23:52.952 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 15:23:52.954 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 15:23:52.978 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
2025-09-01 15:23:53.485 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 15:23:53.497 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 15:23:53.497 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 15:23:53.499 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 15:23:53.555 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 15:23:53.555 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1203 ms
2025-09-01 15:23:54.591 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 15:23:54.605 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 15:23:54.607 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 15:23:54.641 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7185e611:0/SimpleConnection@c6bf8d9 [delegate=amqp://guest@127.0.0.1:5672/, localPort=54844]
2025-09-01 15:23:54.646 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 15:23:54.703 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.695 seconds (process running for 3.529)
2025-09-01 15:24:01.968 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 15:24:01.968 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 15:24:01.969 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 15:24:02.070 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 15:24:02.310 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6faec2df
2025-09-01 15:24:02.312 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 15:24:02.491 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:24:02.534 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:24:02.550 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:24:04.554 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:24:04.565 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:24:06.567 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:24:06.579 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:24:06.580 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_coin_coin01_2的发奖已重试三次，依旧失败
2025-09-01 15:37:51.962 [http-nio-8081-exec-3] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:37:51.966 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:37:51.976 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:37:53.980 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:37:53.989 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:37:55.991 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:37:56.002 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:37:56.003 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_coin_coin01_2的发奖已重试三次，依旧失败
2025-09-01 15:38:08.330 [http-nio-8081-exec-4] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:38:08.335 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:38:08.346 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:38:10.347 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:38:10.358 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:38:12.361 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:38:12.367 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_coin_coin01_2的发奖已重试三次，依旧失败
2025-09-01 15:38:33.455 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:38:35.459 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:39:02.668 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:39:04.670 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:39:04.675 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_coin_coin01_2的发奖已重试三次，依旧失败
2025-09-01 15:40:52.824 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 15:40:53.753 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 15:40:53.755 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 15:40:53.774 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 15:40:53.794 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 15:40:53.799 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 15:40:56.546 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 18568 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 15:40:56.548 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 15:40:57.239 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 15:40:57.241 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 15:40:57.267 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-01 15:40:57.879 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 15:40:57.892 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 15:40:57.894 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 15:40:57.894 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 15:40:57.950 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 15:40:57.950 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1351 ms
2025-09-01 15:41:00.427 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 15:41:00.474 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 15:41:00.478 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 15:41:00.549 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#22686ddb:0/SimpleConnection@4203529f [delegate=amqp://guest@127.0.0.1:5672/, localPort=55307]
2025-09-01 15:41:00.564 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 15:41:00.696 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 4.479 seconds (process running for 5.579)
2025-09-01 15:41:05.003 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 15:41:05.003 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 15:41:05.004 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-01 15:42:02.445 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 15:42:06.205 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@71b3ed2a
2025-09-01 15:42:06.212 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 15:45:36.163 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=47s760ms828µs700ns).
2025-09-01 15:46:13.770 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:46:13.825 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:46:13.839 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:46:13.875 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 15:46:15.843 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:46:15.855 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:46:20.061 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 27556 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 15:46:20.064 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 15:46:20.757 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 15:46:20.759 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 15:46:20.784 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-01 15:46:21.340 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 15:46:21.353 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 15:46:21.355 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 15:46:21.355 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 15:46:21.415 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 15:46:21.415 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1300 ms
2025-09-01 15:46:23.714 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 15:46:23.757 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 15:46:23.762 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 15:46:23.860 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#45b96e4c:0/SimpleConnection@78b8f818 [delegate=amqp://guest@127.0.0.1:5672/, localPort=54563]
2025-09-01 15:46:23.876 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 15:46:24.005 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 4.296 seconds (process running for 5.671)
2025-09-01 15:46:24.127 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:46:24.138 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 15:46:25.353 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@38f37b19
2025-09-01 15:46:25.358 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 15:46:44.128 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=48s769ms717µs100ns).
2025-09-01 15:46:54.405 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 15:46:54.405 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 15:46:54.406 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 15:46:54.504 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:46:54.603 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:46:54.710 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 15:46:56.512 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:46:56.523 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:47:01.633 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 15072 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 15:47:01.634 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 15:47:02.284 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 15:47:02.286 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 15:47:02.310 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-01 15:47:02.859 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 15:47:02.873 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 15:47:02.875 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 15:47:02.875 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 15:47:02.935 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 15:47:02.936 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1260 ms
2025-09-01 15:47:05.341 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 15:47:05.383 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 15:47:05.388 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 15:47:05.472 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#8383a14:0/SimpleConnection@1e9d721 [delegate=amqp://guest@127.0.0.1:5672/, localPort=59457]
2025-09-01 15:47:05.489 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 15:47:05.620 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 4.301 seconds (process running for 5.437)
2025-09-01 15:47:05.749 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:47:05.758 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 15:47:06.338 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4f70d487
2025-09-01 15:47:06.342 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 15:47:10.986 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:47:11.291 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 15:47:12.995 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:47:13.006 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:47:15.011 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:47:15.023 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 调用下游发奖失败，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2，失败原因为type为coin, subType为null的奖励不存在
2025-09-01 15:47:15.025 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_coin_coin01_2的发奖已重试三次，依旧失败
2025-09-01 15:47:15.030 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] WARN  o.s.a.r.listener.SimpleMessageListenerContainer - Rejecting received message(s) because the listener container has been stopped: (Body:'[B@32686b17(byte[214])' MessageProperties [headers={__TypeId__=com.reward_project.play_record.entity.PrizeRecord}, contentType=application/json, contentEncoding=UTF-8, contentLength=0, receivedDeliveryMode=PERSISTENT, priority=0, redelivered=true, receivedExchange=REWARD_RETRY_EXCHANGE, receivedRoutingKey=REWARD_RETRY_ROUTING, deliveryTag=2, consumerTag=amq.ctag-VL9NIo01c4B9A6sCKTlHeg, consumerQueue=REWARD_RETRY_QUEUE])
2025-09-01 15:47:15.031 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 15:47:15.033 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 15:47:15.054 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 15:47:15.075 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 15:47:15.081 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 15:50:05.690 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 28952 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 15:50:05.691 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 15:50:06.307 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 15:50:06.309 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 15:50:06.333 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-01 15:50:06.772 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 15:50:06.782 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 15:50:06.783 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 15:50:06.784 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 15:50:06.839 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 15:50:06.840 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1103 ms
2025-09-01 15:50:07.821 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 15:50:07.836 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 15:50:07.838 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 15:50:07.871 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#44d43cc9:0/SimpleConnection@4738131e [delegate=amqp://guest@127.0.0.1:5672/, localPort=59510]
2025-09-01 15:50:07.876 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 15:50:07.927 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.544 seconds (process running for 3.313)
2025-09-01 15:50:07.980 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:50:07.984 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 15:50:08.233 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@706d6ccb
2025-09-01 15:50:08.234 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 15:50:15.913 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 15:50:15.913 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 15:50:15.914 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 15:50:17.014 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为540，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 15:53:30.580 [http-nio-8081-exec-3] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为570，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 17:10:09.973 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1h13m1s554ms978µs500ns).
2025-09-01 17:12:25.435 [http-nio-8081-exec-5] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为600，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 17:12:30.113 [http-nio-8081-exec-6] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为630，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 17:21:48.377 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 17:21:48.830 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 17:21:48.834 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 17:21:49.061 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 17:21:49.139 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 17:21:49.147 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 18:04:00.551 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 12460 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 18:04:00.554 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 18:04:01.220 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 18:04:01.222 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 18:04:01.252 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 0 Redis repository interfaces.
2025-09-01 18:04:01.680 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 18:04:01.690 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 18:04:01.692 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 18:04:01.692 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 18:04:01.745 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 18:04:01.746 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1149 ms
2025-09-01 18:04:02.176 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'syncController': Unsatisfied dependency expressed through field 'syncService': Error creating bean with name 'syncServiceImpl': Unsatisfied dependency expressed through field 'abstractPrizeHandler': No qualifying bean of type 'com.reward_project.play_record.service.handler.AbstractPrizeHandler' available: expected single matching bean but found 3: coinPrizeHandler,creditPrizeHandler,redPocketPrizeHandler
2025-09-01 18:04:02.180 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-09-01 18:04:02.188 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-09-01 18:04:02.204 [main] ERROR o.s.b.diagnostics.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Field abstractPrizeHandler in com.reward_project.play_record.service.impl.SyncServiceImpl required a single bean, but 3 were found:
	- coinPrizeHandler: defined in file [D:\grad1\project\play_record\target\classes\com\reward_project\play_record\service\handler\CoinPrizeHandler.class]
	- creditPrizeHandler: defined in file [D:\grad1\project\play_record\target\classes\com\reward_project\play_record\service\handler\CreditPrizeHandler.class]
	- redPocketPrizeHandler: defined in file [D:\grad1\project\play_record\target\classes\com\reward_project\play_record\service\handler\RedPocketPrizeHandler.class]

This may be due to missing parameter name information

Action:

Consider marking one of the beans as @Primary, updating the consumer to accept multiple beans, or using @Qualifier to identify the bean that should be consumed

Ensure that your compiler is configured to use the '-parameters' flag.
You may need to update both your build tool settings as well as your IDE.
(See https://github.com/spring-projects/spring-framework/wiki/Spring-Framework-6.1-Release-Notes#parameter-name-retention)


2025-09-01 18:05:06.744 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 31768 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 18:05:06.745 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 18:05:07.421 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 18:05:07.423 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 18:05:07.449 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2025-09-01 18:05:07.934 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 18:05:07.946 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 18:05:07.947 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 18:05:07.948 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 18:05:08.006 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 18:05:08.006 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1213 ms
2025-09-01 18:05:09.065 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 18:05:09.082 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 18:05:09.084 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 18:05:09.128 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4d67d5a4:0/SimpleConnection@77f7352a [delegate=amqp://guest@127.0.0.1:5672/, localPort=64391]
2025-09-01 18:05:09.133 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 18:05:09.188 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.765 seconds (process running for 3.517)
2025-09-01 18:05:28.887 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 18:05:28.888 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 18:05:28.888 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-01 18:05:28.994 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 18:05:29.335 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6185f443
2025-09-01 18:05:29.337 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 18:06:25.601 [http-nio-8081-exec-5] ERROR c.r.play_record.service.impl.PlayRecordServiceImpl - 9用户播放33的记录插入失败
2025-09-01 18:14:32.445 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 18:14:33.096 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 18:14:33.096 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 18:14:33.119 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 18:14:33.136 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 18:14:33.141 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 18:14:36.676 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 21604 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 18:14:36.677 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 18:14:37.356 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 18:14:37.358 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 18:14:37.384 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2025-09-01 18:14:37.876 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 18:14:37.887 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 18:14:37.888 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 18:14:37.888 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 18:14:37.947 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 18:14:37.947 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1222 ms
2025-09-01 18:14:39.010 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 18:14:39.032 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 18:14:39.034 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 18:14:39.068 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7493d937:0/SimpleConnection@4fd92289 [delegate=amqp://guest@127.0.0.1:5672/, localPort=49788]
2025-09-01 18:14:39.073 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 18:14:39.121 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.756 seconds (process running for 3.54)
2025-09-01 18:14:44.985 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 18:14:44.985 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 18:14:44.986 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 18:14:45.078 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 18:14:45.319 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@257c123b
2025-09-01 18:14:45.321 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 18:14:52.425 [http-nio-8081-exec-7] ERROR c.r.play_record.service.impl.PlayRecordServiceImpl - 9用户播放33的记录插入失败
2025-09-01 18:14:54.952 [http-nio-8081-exec-6] ERROR c.r.play_record.service.impl.PlayRecordServiceImpl - 9用户播放33的记录插入失败
2025-09-01 18:22:20.508 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 18:22:20.835 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 18:22:20.836 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 18:22:20.857 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 18:22:20.880 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 18:22:20.887 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 18:22:26.966 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 30888 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 18:22:26.967 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 18:22:27.618 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 18:22:27.620 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 18:22:27.646 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2025-09-01 18:22:28.171 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 18:22:28.183 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 18:22:28.184 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 18:22:28.185 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 18:22:28.248 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 18:22:28.248 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1235 ms
2025-09-01 18:22:29.275 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 18:22:29.291 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 18:22:29.294 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 18:22:29.331 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#a3b858f:0/SimpleConnection@1a8b22b5 [delegate=amqp://guest@127.0.0.1:5672/, localPort=62430]
2025-09-01 18:22:29.335 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 18:22:29.388 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.738 seconds (process running for 3.564)
2025-09-01 18:22:49.122 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 18:22:49.122 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 18:22:49.123 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 18:22:49.223 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 18:22:49.466 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1cfb7a7b
2025-09-01 18:22:49.467 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 18:22:49.573 [http-nio-8081-exec-1] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:22:55.452 [http-nio-8081-exec-3] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:22:55.866 [http-nio-8081-exec-3] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为420，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:22:56.753 [http-nio-8081-exec-5] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:22:56.784 [http-nio-8081-exec-5] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为450，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:22:57.669 [http-nio-8081-exec-2] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:22:57.711 [http-nio-8081-exec-2] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为480，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:22:58.492 [http-nio-8081-exec-6] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:22:58.518 [http-nio-8081-exec-6] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为510，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:09.447 [http-nio-8081-exec-4] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:09.499 [http-nio-8081-exec-4] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为540，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:12.246 [http-nio-8081-exec-7] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:12.294 [http-nio-8081-exec-7] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为570，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:13.150 [http-nio-8081-exec-10] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:13.199 [http-nio-8081-exec-10] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为600，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:14.045 [http-nio-8081-exec-8] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:14.078 [http-nio-8081-exec-8] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为630，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:14.862 [http-nio-8081-exec-9] ERROR c.r.play_record.service.impl.PlayRecordServiceImpl - 9用户播放33的记录插入失败
2025-09-01 18:23:14.871 [http-nio-8081-exec-9] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:14.914 [http-nio-8081-exec-9] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为630，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 18:23:29.698 [http-nio-8081-exec-1] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第3阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为2，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_3
2025-09-01 18:37:05.929 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 18:37:06.482 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 18:37:06.484 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 18:37:06.504 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 18:37:06.524 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 18:37:06.529 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 18:58:43.868 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 9956 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 18:58:43.870 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 18:58:44.518 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 18:58:44.520 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 18:58:44.542 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
2025-09-01 18:58:44.976 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 18:58:44.988 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 18:58:44.989 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 18:58:44.990 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 18:58:45.047 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 18:58:45.047 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1118 ms
2025-09-01 18:58:46.081 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 18:58:46.106 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 18:58:46.108 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 18:58:46.143 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#44d43cc9:0/SimpleConnection@4fd92289 [delegate=amqp://guest@127.0.0.1:5672/, localPort=51622]
2025-09-01 18:58:46.148 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 18:58:46.193 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.654 seconds (process running for 3.446)
2025-09-01 18:58:59.835 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 18:58:59.836 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 18:58:59.839 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-09-01 18:58:59.992 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 18:59:00.395 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1a938f5f
2025-09-01 18:59:00.397 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 18:59:00.532 [http-nio-8081-exec-1] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第3阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为2，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_3
2025-09-01 18:59:01.343 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为690，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_3
2025-09-01 18:59:14.913 [http-nio-8081-exec-7] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第3阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为2，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_3
2025-09-01 18:59:14.960 [http-nio-8081-exec-7] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为720，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_3
2025-09-01 19:49:22.268 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 19:49:23.168 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 19:49:23.170 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 19:49:23.195 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 19:49:23.224 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 19:49:23.228 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 19:49:31.739 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 8996 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 19:49:31.741 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 19:49:32.409 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 19:49:32.411 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 19:49:32.436 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-01 19:49:32.875 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 19:49:32.885 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 19:49:32.886 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 19:49:32.886 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 19:49:32.949 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 19:49:32.950 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1165 ms
2025-09-01 19:49:33.387 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'syncController': Unsatisfied dependency expressed through field 'syncService': Error creating bean with name 'syncServiceImpl': Unsatisfied dependency expressed through field 'prizeHandlerFactory': Error creating bean with name 'prizeHandlerFactory' defined in file [D:\grad1\project\play_record\target\classes\com\reward_project\play_record\service\handler\PrizeHandlerFactory.class]: Failed to instantiate [com.reward_project.play_record.service.handler.PrizeHandlerFactory]: Constructor threw exception
2025-09-01 19:49:33.392 [main] INFO  org.apache.catalina.core.StandardService - Stopping service [Tomcat]
2025-09-01 19:49:33.400 [main] INFO  o.s.b.a.logging.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-09-01 19:49:33.411 [main] ERROR org.springframework.boot.SpringApplication - Application run failed
org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'syncController': Unsatisfied dependency expressed through field 'syncService': Error creating bean with name 'syncServiceImpl': Unsatisfied dependency expressed through field 'prizeHandlerFactory': Error creating bean with name 'prizeHandlerFactory' defined in file [D:\grad1\project\play_record\target\classes\com\reward_project\play_record\service\handler\PrizeHandlerFactory.class]: Failed to instantiate [com.reward_project.play_record.service.handler.PrizeHandlerFactory]: Constructor threw exception
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:788)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:768)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:146)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:509)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1459)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:606)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1222)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1188)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1123)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.reward_project.play_record.PlayRecordApplication.main(PlayRecordApplication.java:10)
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'syncServiceImpl': Unsatisfied dependency expressed through field 'prizeHandlerFactory': Error creating bean with name 'prizeHandlerFactory' defined in file [D:\grad1\project\play_record\target\classes\com\reward_project\play_record\service\handler\PrizeHandlerFactory.class]: Failed to instantiate [com.reward_project.play_record.service.handler.PrizeHandlerFactory]: Constructor threw exception
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:788)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:768)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:146)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:509)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1459)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:606)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1752)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1635)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:785)
	... 22 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'prizeHandlerFactory' defined in file [D:\grad1\project\play_record\target\classes\com\reward_project\play_record\service\handler\PrizeHandlerFactory.class]: Failed to instantiate [com.reward_project.play_record.service.handler.PrizeHandlerFactory]: Constructor threw exception
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1357)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1242)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:569)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1690)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1635)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:785)
	... 36 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.reward_project.play_record.service.handler.PrizeHandlerFactory]: Constructor threw exception
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:223)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:123)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1351)
	... 46 common frames omitted
Caused by: java.lang.NullPointerException: Cannot invoke "org.springframework.context.ApplicationContext.getBean(String, java.lang.Class)" because "this.this$0.applicationContext" is null
	at com.reward_project.play_record.service.handler.PrizeHandlerFactory$1.<init>(PrizeHandlerFactory.java:21)
	at com.reward_project.play_record.service.handler.PrizeHandlerFactory.<init>(PrizeHandlerFactory.java:20)
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:483)
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:197)
	... 48 common frames omitted
2025-09-01 19:53:48.391 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 22916 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 19:53:48.393 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 19:53:49.002 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 19:53:49.011 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 19:53:49.037 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
2025-09-01 19:53:49.479 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 19:53:49.490 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 19:53:49.491 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 19:53:49.491 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 19:53:49.547 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 19:53:49.547 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1111 ms
2025-09-01 19:53:50.536 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 19:53:50.550 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 19:53:50.553 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 19:53:50.589 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#2475fba3:0/SimpleConnection@681b42d3 [delegate=amqp://guest@127.0.0.1:5672/, localPort=61221]
2025-09-01 19:53:50.594 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 19:53:50.643 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.57 seconds (process running for 3.285)
2025-09-01 19:54:10.730 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 19:54:10.731 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 19:54:10.732 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 19:54:10.821 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 19:54:11.070 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4e5c3baf
2025-09-01 19:54:11.071 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 19:54:11.186 [http-nio-8081-exec-1] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第3阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为2，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_3
2025-09-01 19:54:11.671 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为750，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_3
2025-09-01 19:55:34.861 [http-nio-8081-exec-4] INFO  c.r.play_record.service.impl.SyncServiceImpl - 用户9在2025-09-01第一次插入总时长
2025-09-01 19:55:34.870 [http-nio-8081-exec-4] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为30，未达到最低发奖门槛
2025-09-01 19:55:41.929 [http-nio-8081-exec-3] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为60，未达到最低发奖门槛
2025-09-01 19:55:43.028 [http-nio-8081-exec-5] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为90，未达到最低发奖门槛
2025-09-01 19:55:44.134 [http-nio-8081-exec-6] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为120，未达到最低发奖门槛
2025-09-01 19:55:59.602 [http-nio-8081-exec-7] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为150，未达到最低发奖门槛
2025-09-01 19:56:00.606 [http-nio-8081-exec-8] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_1
2025-09-01 19:56:49.351 [http-nio-8081-exec-9] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_1
2025-09-01 19:56:49.392 [http-nio-8081-exec-9] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为210，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_1
2025-09-01 19:56:50.284 [http-nio-8081-exec-10] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_1
2025-09-01 19:56:50.325 [http-nio-8081-exec-10] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为240，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_1
2025-09-01 19:56:51.227 [http-nio-8081-exec-1] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_1
2025-09-01 19:56:51.272 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为270，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_1
2025-09-01 19:56:52.135 [http-nio-8081-exec-2] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_1
2025-09-01 19:56:52.172 [http-nio-8081-exec-2] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为300，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_1
2025-09-01 19:56:53.070 [http-nio-8081-exec-4] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为red_pocket子类型为red_pocket01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_red_pocket_red_pocket01_2
2025-09-01 19:57:20.469 [http-nio-8081-exec-3] INFO  c.r.play_record.service.impl.SyncServiceImpl - 用户9在2025-09-01第一次插入总时长
2025-09-01 19:57:20.477 [http-nio-8081-exec-3] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为30，未达到最低发奖门槛
2025-09-01 19:57:21.421 [http-nio-8081-exec-5] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为60，未达到最低发奖门槛
2025-09-01 19:57:22.186 [http-nio-8081-exec-6] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为90，未达到最低发奖门槛
2025-09-01 19:57:30.028 [http-nio-8081-exec-7] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为120，未达到最低发奖门槛
2025-09-01 19:57:30.845 [http-nio-8081-exec-8] ERROR c.r.play_record.service.impl.PlayRecordServiceImpl - 9用户播放33的记录插入失败
2025-09-01 19:57:30.856 [http-nio-8081-exec-8] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为120，未达到最低发奖门槛
2025-09-01 19:57:31.747 [http-nio-8081-exec-9] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为150，未达到最低发奖门槛
2025-09-01 19:57:42.102 [http-nio-8081-exec-10] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 19:58:31.640 [http-nio-8081-exec-1] INFO  c.r.play_record.service.impl.SyncServiceImpl - 用户9在2025-09-01第一次插入总时长
2025-09-01 19:58:31.648 [http-nio-8081-exec-1] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为30，未达到最低发奖门槛
2025-09-01 19:58:32.847 [http-nio-8081-exec-2] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为60，未达到最低发奖门槛
2025-09-01 19:58:33.744 [http-nio-8081-exec-4] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为90，未达到最低发奖门槛
2025-09-01 19:58:34.918 [http-nio-8081-exec-3] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为120，未达到最低发奖门槛
2025-09-01 19:58:36.251 [http-nio-8081-exec-5] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为150，未达到最低发奖门槛
2025-09-01 19:58:37.690 [http-nio-8081-exec-6] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为credit子类型为credit01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_credit_credit01_1
2025-09-01 19:58:56.862 [http-nio-8081-exec-7] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为credit子类型为credit01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_credit_credit01_1
2025-09-01 19:58:56.908 [http-nio-8081-exec-7] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为210，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_credit_credit01_1
2025-09-01 19:59:26.458 [http-nio-8081-exec-8] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为credit子类型为credit01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_credit_credit01_1
2025-09-01 19:59:26.509 [http-nio-8081-exec-8] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为240，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_credit_credit01_1
2025-09-01 19:59:27.368 [http-nio-8081-exec-9] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为credit子类型为credit01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_credit_credit01_1
2025-09-01 19:59:27.408 [http-nio-8081-exec-9] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为270，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_credit_credit01_1
2025-09-01 19:59:28.323 [http-nio-8081-exec-10] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为credit子类型为credit01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_credit_credit01_1
2025-09-01 19:59:28.366 [http-nio-8081-exec-10] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为300，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_credit_credit01_1
2025-09-01 19:59:29.139 [http-nio-8081-exec-1] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为credit子类型为credit01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_credit_credit01_2
2025-09-01 20:00:15.475 [http-nio-8081-exec-2] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 20:00:15.515 [http-nio-8081-exec-2] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为210，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 20:00:16.388 [http-nio-8081-exec-4] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 20:00:16.429 [http-nio-8081-exec-4] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为240，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 20:00:17.406 [http-nio-8081-exec-3] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 20:00:17.442 [http-nio-8081-exec-3] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为270，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 20:00:18.476 [http-nio-8081-exec-5] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第1阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 20:00:18.517 [http-nio-8081-exec-5] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为300，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_1
2025-09-01 20:00:19.652 [http-nio-8081-exec-6] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:20.489 [http-nio-8081-exec-7] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:20.526 [http-nio-8081-exec-7] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为360，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:21.243 [http-nio-8081-exec-8] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:21.284 [http-nio-8081-exec-8] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为390，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:21.999 [http-nio-8081-exec-9] ERROR c.r.play_record.service.impl.PlayRecordServiceImpl - 9用户播放33的记录插入失败
2025-09-01 20:00:22.007 [http-nio-8081-exec-9] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:22.050 [http-nio-8081-exec-9] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为390，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:22.788 [http-nio-8081-exec-10] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:22.831 [http-nio-8081-exec-10] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为420，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:23.589 [http-nio-8081-exec-1] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:23.626 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为450，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:24.360 [http-nio-8081-exec-2] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:24.394 [http-nio-8081-exec-2] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为480，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:25.228 [http-nio-8081-exec-4] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:25.271 [http-nio-8081-exec-4] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为510，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:26.074 [http-nio-8081-exec-3] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:26.119 [http-nio-8081-exec-3] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为540，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:26.851 [http-nio-8081-exec-5] ERROR c.r.play_record.service.impl.PlayRecordServiceImpl - 9用户播放33的记录插入失败
2025-09-01 20:00:26.858 [http-nio-8081-exec-5] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:26.901 [http-nio-8081-exec-5] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为540，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:27.719 [http-nio-8081-exec-6] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:27.757 [http-nio-8081-exec-6] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为570，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:39.653 [http-nio-8081-exec-7] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:39.693 [http-nio-8081-exec-7] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为600，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:40.760 [http-nio-8081-exec-8] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第2阶段，类型为coin子类型为coin01的奖品，数量为1，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:40.795 [http-nio-8081-exec-8] ERROR c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为630，本阶段已发奖，外部业务号为musicPlay_9_2025-09-01_coin_coin01_2
2025-09-01 20:00:41.799 [http-nio-8081-exec-9] INFO  c.r.p.service.handler.AbstractPrizeHandler - 在场景musicPlay下，给用户9发第3阶段，类型为coin子类型为coin01的奖品，数量为2，外部业务号为musicPlay_9_2025-09-01_coin_coin01_3
2025-09-01 21:09:07.143 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=47m25s752ms798µs900ns).
2025-09-01 21:20:10.836 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 21:20:11.683 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 21:20:11.685 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 21:20:11.707 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 21:20:11.728 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 21:20:11.731 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 23:18:30.487 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 11324 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 23:18:30.489 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 23:18:31.166 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 23:18:31.169 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 23:18:31.194 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2025-09-01 23:18:31.651 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 23:18:31.662 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 23:18:31.663 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 23:18:31.663 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 23:18:31.715 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 23:18:31.716 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1177 ms
2025-09-01 23:18:32.781 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 23:18:32.796 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 23:18:32.798 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 23:18:32.835 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#59e7564b:0/SimpleConnection@47fca3cc [delegate=amqp://guest@127.0.0.1:5672/, localPort=51744]
2025-09-01 23:18:32.840 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 23:18:32.891 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.726 seconds (process running for 3.465)
2025-09-01 23:19:07.195 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 23:19:07.913 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 23:19:07.914 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 23:19:07.936 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 23:20:15.494 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 13724 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 23:20:15.497 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 23:20:16.144 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 23:20:16.146 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 23:20:16.170 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2025-09-01 23:20:16.654 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 23:20:16.665 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 23:20:16.666 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 23:20:16.666 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 23:20:16.719 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 23:20:16.719 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1176 ms
2025-09-01 23:20:17.763 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 23:20:17.778 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 23:20:17.781 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 23:20:17.816 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#561d88ee:0/SimpleConnection@6c13019c [delegate=amqp://guest@127.0.0.1:5672/, localPort=51766]
2025-09-01 23:20:17.821 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 23:20:17.866 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.692 seconds (process running for 3.51)
2025-09-01 23:24:04.251 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 23:24:05.030 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 23:24:05.031 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 23:24:05.049 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 23:24:08.733 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 5448 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 23:24:08.735 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 23:24:09.390 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 23:24:09.392 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 23:24:09.417 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2025-09-01 23:24:09.893 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 23:24:09.904 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 23:24:09.905 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 23:24:09.906 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 23:24:09.963 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 23:24:09.963 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1180 ms
2025-09-01 23:24:11.010 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 23:24:11.025 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 23:24:11.028 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 23:24:11.063 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#30fbc23:0/SimpleConnection@146fa9c0 [delegate=amqp://guest@127.0.0.1:5672/, localPort=50242]
2025-09-01 23:24:11.068 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 23:24:11.117 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.712 seconds (process running for 3.511)
2025-09-01 23:24:41.480 [http-nio-8081-exec-2] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 23:24:41.481 [http-nio-8081-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 23:24:41.482 [http-nio-8081-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 23:24:41.514 [http-nio-8081-exec-2] WARN  o.s.w.s.m.support.DefaultHandlerExceptionResolver - Resolved [org.springframework.http.converter.HttpMessageNotReadableException: Required request body is missing: private com.reward_project.play_record.controller.vo.BaseVO com.reward_project.play_record.controller.RewardRuleController.addRule(com.reward_project.play_record.entity.RewardRule)]
2025-09-01 23:27:15.675 [http-nio-8081-exec-3] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 23:27:15.916 [http-nio-8081-exec-3] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4440e8c7
2025-09-01 23:27:15.918 [http-nio-8081-exec-3] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 23:31:59.678 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 23:31:59.831 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 23:31:59.832 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 23:31:59.855 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 23:31:59.874 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 23:31:59.880 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 23:32:06.375 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 31532 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 23:32:06.378 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 23:32:07.011 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 23:32:07.012 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 23:32:07.038 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
2025-09-01 23:32:07.523 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 23:32:07.535 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 23:32:07.536 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 23:32:07.536 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 23:32:07.591 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 23:32:07.591 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1170 ms
2025-09-01 23:32:08.649 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 23:32:08.663 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 23:32:08.665 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 23:32:08.699 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5f883d90:0/SimpleConnection@62a41279 [delegate=amqp://guest@127.0.0.1:5672/, localPort=50488]
2025-09-01 23:32:08.704 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 23:32:08.749 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.71 seconds (process running for 3.54)
2025-09-01 23:32:10.689 [http-nio-8081-exec-2] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 23:32:10.690 [http-nio-8081-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 23:32:10.691 [http-nio-8081-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 23:32:10.730 [http-nio-8081-exec-2] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 23:32:10.970 [http-nio-8081-exec-2] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5664a5ba
2025-09-01 23:32:10.971 [http-nio-8081-exec-2] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 23:33:19.903 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 23:33:20.787 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 23:33:20.789 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 23:33:20.810 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 23:33:20.832 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 23:33:20.838 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 23:33:26.656 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 29224 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 23:33:26.658 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 23:33:27.310 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 23:33:27.312 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 23:33:27.336 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2025-09-01 23:33:27.779 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 23:33:27.790 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 23:33:27.791 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 23:33:27.791 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 23:33:27.858 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 23:33:27.858 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1161 ms
2025-09-01 23:33:28.902 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 23:33:28.919 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 23:33:28.921 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 23:33:28.952 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6793f752:0/SimpleConnection@47fca3cc [delegate=amqp://guest@127.0.0.1:5672/, localPort=50524]
2025-09-01 23:33:28.957 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 23:33:29.014 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.681 seconds (process running for 3.579)
2025-09-01 23:33:32.508 [http-nio-8081-exec-2] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 23:33:32.508 [http-nio-8081-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 23:33:32.509 [http-nio-8081-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 23:33:32.551 [http-nio-8081-exec-2] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 23:33:32.806 [http-nio-8081-exec-2] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@f0d6820
2025-09-01 23:33:32.809 [http-nio-8081-exec-2] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 23:35:05.884 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 23:35:06.086 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 23:35:06.087 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 23:35:06.109 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 23:35:06.136 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 23:35:06.141 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 23:35:17.659 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 13044 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 23:35:17.661 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 23:35:18.314 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 23:35:18.316 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 23:35:18.341 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2025-09-01 23:35:18.788 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 23:35:18.798 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 23:35:18.799 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 23:35:18.800 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 23:35:18.854 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 23:35:18.855 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1149 ms
2025-09-01 23:35:19.834 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 23:35:19.849 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 23:35:19.851 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 23:35:19.884 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#2c34402:0/SimpleConnection@13a9cdae [delegate=amqp://guest@127.0.0.1:5672/, localPort=50574]
2025-09-01 23:35:19.889 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 23:35:19.935 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.581 seconds (process running for 3.34)
2025-09-01 23:35:23.229 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 23:35:23.229 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 23:35:23.230 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 23:35:23.269 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 23:35:23.498 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@228f6117
2025-09-01 23:35:23.499 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 23:51:05.830 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 23:51:06.425 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 23:51:06.427 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 23:51:06.449 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 23:51:06.466 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 23:51:06.472 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 23:51:11.131 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 32576 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 23:51:11.133 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 23:51:11.753 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 23:51:11.756 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 23:51:11.780 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-01 23:51:12.220 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 23:51:12.231 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 23:51:12.232 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 23:51:12.232 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 23:51:12.285 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 23:51:12.285 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1107 ms
2025-09-01 23:51:13.291 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 23:51:13.308 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 23:51:13.311 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 23:51:13.346 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5d3f99d7:0/SimpleConnection@1c972ae6 [delegate=amqp://guest@127.0.0.1:5672/, localPort=50773]
2025-09-01 23:51:13.351 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 23:51:13.399 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 2.585 seconds (process running for 3.36)
2025-09-01 23:51:19.475 [http-nio-8081-exec-5] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 23:51:19.475 [http-nio-8081-exec-5] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 23:51:19.476 [http-nio-8081-exec-5] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 23:51:19.520 [http-nio-8081-exec-5] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 23:51:19.764 [http-nio-8081-exec-5] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6107bb2d
2025-09-01 23:51:19.765 [http-nio-8081-exec-5] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 23:53:48.536 [http-nio-8081-exec-6] INFO  c.r.play_record.service.impl.SyncServiceImpl - 用户9在2025-09-01第一次插入总时长
2025-09-01 23:53:48.632 [http-nio-8081-exec-6] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为30，未达到最低发奖门槛
2025-09-01 23:54:27.333 [http-nio-8081-exec-3] INFO  c.r.play_record.service.impl.SyncServiceImpl - 用户9在2025-09-01第一次插入总时长
2025-09-01 23:54:27.346 [http-nio-8081-exec-3] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为30，未达到最低发奖门槛
2025-09-01 23:54:53.752 [http-nio-8081-exec-4] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为60，未达到最低发奖门槛
2025-09-01 23:54:57.989 [http-nio-8081-exec-8] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为90，未达到最低发奖门槛
2025-09-01 23:54:58.770 [http-nio-8081-exec-9] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为120，未达到最低发奖门槛
2025-09-01 23:54:59.548 [http-nio-8081-exec-10] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为150，未达到最低发奖门槛
2025-09-01 23:55:00.620 [http-nio-8081-exec-7] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:55:00.661 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1
2025-09-01 23:55:00.670 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:55:01.507 [http-nio-8081-exec-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:55:02.683 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1
2025-09-01 23:55:02.685 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:55:04.689 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1
2025-09-01 23:55:04.691 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:55:04.693 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1的发奖已重试三次，依旧失败
2025-09-01 23:55:04.698 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1
2025-09-01 23:55:04.700 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:55:06.710 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1
2025-09-01 23:55:06.712 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:55:08.721 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1
2025-09-01 23:55:08.722 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:55:08.724 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1的发奖已重试三次，依旧失败
2025-09-01 23:56:39.792 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 23:56:40.056 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 23:56:40.057 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 23:56:40.090 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 23:56:40.117 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 23:56:40.124 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 23:57:25.944 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 15216 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 23:57:25.946 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 23:57:26.653 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 23:57:26.655 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 23:57:26.682 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
2025-09-01 23:57:27.267 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 23:57:27.284 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 23:57:27.286 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 23:57:27.286 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 23:57:27.357 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 23:57:27.357 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1364 ms
2025-09-01 23:57:28.862 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 23:57:28.881 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 23:57:28.884 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 23:57:28.932 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5d3f99d7:0/SimpleConnection@2e66f1bd [delegate=amqp://guest@127.0.0.1:5672/, localPort=50451]
2025-09-01 23:57:28.939 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 23:57:29.004 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 3.409 seconds (process running for 4.287)
2025-09-01 23:57:41.204 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 23:57:41.204 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 23:57:41.205 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-01 23:57:41.295 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-01 23:57:41.529 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@391c9bf2
2025-09-01 23:57:41.530 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-01 23:57:41.627 [http-nio-8081-exec-1] INFO  c.r.play_record.service.impl.SyncServiceImpl - 用户9在2025-09-01第一次插入总时长
2025-09-01 23:57:41.679 [http-nio-8081-exec-1] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为30，未达到最低发奖门槛
2025-09-01 23:57:51.627 [http-nio-8081-exec-2] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为60，未达到最低发奖门槛
2025-09-01 23:57:52.636 [http-nio-8081-exec-3] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为90，未达到最低发奖门槛
2025-09-01 23:57:53.563 [http-nio-8081-exec-4] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为120，未达到最低发奖门槛
2025-09-01 23:57:54.796 [http-nio-8081-exec-6] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为150，未达到最低发奖门槛
2025-09-01 23:57:55.720 [http-nio-8081-exec-5] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:57:55.765 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1
2025-09-01 23:57:55.771 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:57:57.777 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1
2025-09-01 23:57:57.780 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:57:59.783 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  c.r.p.service.consumer.RewardRetryConsumer - 正在进行重试，外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1
2025-09-01 23:57:59.785 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.play_record.service.impl.SyncServiceImpl - 输入的奖品类型redpocket不存在
2025-09-01 23:57:59.788 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] ERROR c.r.p.service.consumer.RewardRetryConsumer - 外部业务号为musicPlay_9_2025-09-01_redpocket_redpocket01_1的发奖已重试三次，依旧失败
2025-09-01 23:59:32.359 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-01 23:59:32.942 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-01 23:59:32.943 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-01 23:59:32.961 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-01 23:59:32.981 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-01 23:59:32.986 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-01 23:59:35.213 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Starting PlayRecordApplication using Java 24.0.1 with PID 30316 (D:\grad1\project\play_record\target\classes started by 12943 in D:\grad1\project\play_record)
2025-09-01 23:59:35.216 [main] INFO  c.reward_project.play_record.PlayRecordApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-01 23:59:35.883 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-01 23:59:35.886 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-01 23:59:35.919 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
2025-09-01 23:59:36.488 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
2025-09-01 23:59:36.501 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-09-01 23:59:36.502 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-01 23:59:36.502 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-01 23:59:36.562 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-01 23:59:36.562 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1304 ms
2025-09-01 23:59:39.069 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-09-01 23:59:39.109 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path '/'
2025-09-01 23:59:39.113 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-09-01 23:59:39.187 [main] INFO  o.s.a.rabbit.connection.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#704d3b00:0/SimpleConnection@6e90cec8 [delegate=amqp://guest@127.0.0.1:5672/, localPort=50539]
2025-09-01 23:59:39.202 [main] INFO  org.springframework.amqp.rabbit.core.RabbitAdmin - Auto-declaring a non-durable, auto-delete, or exclusive Queue (REWARD_RETRY_QUEUE) durable:false, auto-delete:false, exclusive:false. It will be redeclared if the broker stops and is restarted while the connection factory is alive, but all messages will be lost.
2025-09-01 23:59:39.321 [main] INFO  c.reward_project.play_record.PlayRecordApplication - Started PlayRecordApplication in 4.472 seconds (process running for 5.713)
2025-09-01 23:59:40.725 [http-nio-8081-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-01 23:59:40.725 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-01 23:59:40.725 [http-nio-8081-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-02 00:00:21.601 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-02 00:00:21.906 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Waiting for workers to finish.
2025-09-02 00:00:22.553 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  o.s.a.r.listener.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2025-09-02 00:00:22.553 [SpringApplicationShutdownHook] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-02 00:00:24.934 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1f5a6c6a
2025-09-02 00:00:24.939 [http-nio-8081-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-02 00:00:25.092 [http-nio-8081-exec-1] INFO  c.r.play_record.service.impl.SyncServiceImpl - 用户9在2025-09-02第一次插入总时长
2025-09-02 00:00:25.279 [http-nio-8081-exec-1] WARN  c.r.play_record.service.impl.SyncServiceImpl - 用户9当前播放总时长为30，未达到最低发奖门槛
2025-09-02 00:00:25.357 [tomcat-shutdown] INFO  o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-02 00:00:25.378 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-02 00:00:25.414 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
